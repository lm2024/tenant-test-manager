https://www.tapd.cn/api/aggregation/workitem_aggregation/common_get_info
Request Method
POST

{"workspace_id":"60498179","entity_id":"1160498179001000009","entity_type":"bug","api_controller_prefix":"","enable_description":"true","is_detail":1,"blacklist_fields":["workspace_configs"],"identifier":"app_for_editor,app_for_obj_more,app_for_obj_dialog_dropdown,app_for_obj_detail_panel,app_for_obj_detail_bottom_card,app_for_obj_attachment,app_for_obj_copy_link,app_for_obj_additional_panel","installed_app_entity":{"obj_id":"1160498179001000009","obj_type":"bug","obj_name":"【示例】缺陷2"},"has_edit_rule_fields":[],"is_archived":0,"is_assistant_exec_log":1,"dsc_token":"B14PcWsEU6IsFDYQ"}



{
    "data": {
        "get_info_ret": {
            "data": {
                "Bug": {
                    "id": "1160498179001000009",
                    "secret_root_id": "0",
                    "sid": "0",
                    "project_id": "60498179",
                    "parent_id": "",
                    "title": "\u3010\u793a\u4f8b\u3011\u7f3a\u96772",
                    "description": "\u003Cp\u003Esadf\u0026nbsp;\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003Esdf\u0026nbsp;\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003Esadf\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003Esdf\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003Es\u003C\/p\u003E\u003Cp\u003Edf\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003Esdf\u003C\/p\u003E\u003Cp\u003E\u003Cbr  \/\u003E\u003C\/p\u003E\u003Cp\u003Esd\u003C\/p\u003E",
                    "markdown_description": "",
                    "description_type": "1",
                    "module": "",
                    "milestone": "",
                    "reporter": "TAPD",
                    "deadline": "",
                    "created": "2025-05-30 11:17:18",
                    "resolved": "",
                    "closed": "",
                    "modified": "2025-06-12 16:55:08",
                    "lastmodify": "\u672a\u547d\u540d\u5c0f\u7a0b\u5e8f",
                    "auditer": "",
                    "de": "\u672a\u547d\u540d\u5c0f\u7a0b\u5e8f;",
                    "te": "",
                    "confirmer": "",
                    "current_owner": "\u672a\u547d\u540d\u5c0f\u7a0b\u5e8f;",
                    "participator": "",
                    "closer": "",
                    "status": "in_progress",
                    "resolution": "",
                    "priority": "medium",
                    "severity": "normal",
                    "platform": "",
                    "os": "",
                    "testmode": "",
                    "testtype": "",
                    "testphase": "",
                    "source": "",
                    "frequency": "",
                    "cc": "",
                    "estimate": "",
                    "flows": "|in_progress",
                    "version_report": "\u7248\u672c1",
                    "version_test": "",
                    "version_fix": "",
                    "version_close": "",
                    "delayed": "0",
                    "custom_field_one": "",
                    "custom_field_two": "",
                    "custom_field_three": "",
                    "custom_field_four": "",
                    "custom_field_five": "",
                    "regression_number": "0",
                    "issue_id": "",
                    "support_id": "",
                    "support_forum_id": "",
                    "created_from": "",
                    "baseline_find": "",
                    "baseline_join": "",
                    "baseline_close": "",
                    "ticket_id": "",
                    "story_id": "",
                    "baseline_test": "",
                    "originphase": "",
                    "sourcephase": "",
                    "bugtype": "",
                    "feature": "",
                    "in_progress_time": "2025-06-12 16:55:08",
                    "verify_time": "",
                    "reject_time": "",
                    "reopen_time": "",
                    "audit_time": "",
                    "suspend_time": "",
                    "assigned_time": "",
                    "iteration_id": "0",
                    "custom_field_6": "",
                    "custom_field_7": "",
                    "custom_field_8": "",
                    "custom_field_9": "",
                    "custom_field_10": "",
                    "custom_field_11": "",
                    "custom_field_12": "",
                    "custom_field_13": "",
                    "custom_field_14": "",
                    "custom_field_15": "",
                    "custom_field_16": "",
                    "custom_field_17": "",
                    "custom_field_18": "",
                    "custom_field_19": "",
                    "custom_field_20": "",
                    "custom_field_21": "",
                    "custom_field_22": "",
                    "custom_field_23": "",
                    "custom_field_24": "",
                    "custom_field_25": "",
                    "custom_field_26": "",
                    "custom_field_27": "",
                    "custom_field_28": "",
                    "custom_field_29": "",
                    "custom_field_30": "",
                    "custom_field_31": "",
                    "custom_field_32": "",
                    "custom_field_33": "",
                    "custom_field_34": "",
                    "custom_field_35": "",
                    "custom_field_36": "",
                    "custom_field_37": "",
                    "custom_field_38": "",
                    "custom_field_39": "",
                    "custom_field_40": "",
                    "custom_field_41": "",
                    "custom_field_42": "",
                    "custom_field_43": "",
                    "custom_field_44": "",
                    "custom_field_45": "",
                    "custom_field_46": "",
                    "custom_field_47": "",
                    "custom_field_48": "",
                    "custom_field_49": "",
                    "custom_field_50": "",
                    "custom_field_51": "",
                    "custom_field_52": "",
                    "custom_field_53": "",
                    "custom_field_54": "",
                    "custom_field_55": "",
                    "custom_field_56": "",
                    "custom_field_57": "",
                    "custom_field_58": "",
                    "custom_field_59": "",
                    "custom_field_60": "",
                    "custom_field_61": "",
                    "custom_field_62": "",
                    "custom_field_63": "",
                    "custom_field_64": "",
                    "custom_field_65": "",
                    "custom_field_66": "",
                    "custom_field_67": "",
                    "custom_field_68": "",
                    "custom_field_69": "",
                    "custom_field_70": "",
                    "custom_field_71": "",
                    "custom_field_72": "",
                    "custom_field_73": "",
                    "custom_field_74": "",
                    "custom_field_75": "",
                    "custom_field_76": "",
                    "custom_field_77": "",
                    "custom_field_78": "",
                    "custom_field_79": "",
                    "custom_field_80": "",
                    "custom_field_81": "",
                    "custom_field_82": "",
                    "custom_field_83": "",
                    "custom_field_84": "",
                    "custom_field_85": "",
                    "custom_field_86": "",
                    "custom_field_87": "",
                    "custom_field_88": "",
                    "custom_field_89": "",
                    "custom_field_90": "",
                    "custom_field_91": "",
                    "custom_field_92": "",
                    "custom_field_93": "",
                    "custom_field_94": "",
                    "custom_field_95": "",
                    "custom_field_96": "",
                    "custom_field_97": "",
                    "custom_field_98": "",
                    "custom_field_99": "",
                    "custom_field_100": "",
                    "custom_plan_field_1": "0",
                    "custom_plan_field_2": "0",
                    "custom_plan_field_3": "0",
                    "custom_plan_field_4": "0",
                    "custom_plan_field_5": "0",
                    "custom_plan_field_6": "0",
                    "custom_plan_field_7": "0",
                    "custom_plan_field_8": "0",
                    "custom_plan_field_9": "0",
                    "custom_plan_field_10": "0",
                    "template_id": "1160498179001000029",
                    "begin": "",
                    "due": "",
                    "release_id": "",
                    "fixer": "",
                    "follower": "",
                    "sync_type": "",
                    "label": "",
                    "effort": "",
                    "effort_completed": "0",
                    "exceed": "0",
                    "remain": "0",
                    "progress": "0",
                    "size": "",
                    "custom_field_101": "",
                    "custom_field_102": "",
                    "custom_field_103": "",
                    "custom_field_104": "",
                    "custom_field_105": "",
                    "custom_field_106": "",
                    "custom_field_107": "",
                    "custom_field_108": "",
                    "custom_field_109": "",
                    "custom_field_110": "",
                    "custom_field_111": "",
                    "custom_field_112": "",
                    "custom_field_113": "",
                    "custom_field_114": "",
                    "custom_field_115": "",
                    "custom_field_116": "",
                    "custom_field_117": "",
                    "custom_field_118": "",
                    "custom_field_119": "",
                    "custom_field_120": "",
                    "custom_field_121": "",
                    "custom_field_122": "",
                    "custom_field_123": "",
                    "custom_field_124": "",
                    "custom_field_125": "",
                    "custom_field_126": "",
                    "custom_field_127": "",
                    "custom_field_128": "",
                    "custom_field_129": "",
                    "custom_field_130": "",
                    "custom_field_131": "",
                    "custom_field_132": "",
                    "custom_field_133": "",
                    "custom_field_134": "",
                    "custom_field_135": "",
                    "custom_field_136": "",
                    "custom_field_137": "",
                    "custom_field_138": "",
                    "custom_field_139": "",
                    "custom_field_140": "",
                    "custom_field_141": "",
                    "custom_field_142": "",
                    "custom_field_143": "",
                    "custom_field_144": "",
                    "custom_field_145": "",
                    "custom_field_146": "",
                    "custom_field_147": "",
                    "custom_field_148": "",
                    "custom_field_149": "",
                    "custom_field_150": "",
                    "custom_field_151": "",
                    "custom_field_152": "",
                    "custom_field_153": "",
                    "custom_field_154": "",
                    "custom_field_155": "",
                    "custom_field_156": "",
                    "custom_field_157": "",
                    "custom_field_158": "",
                    "custom_field_159": "",
                    "custom_field_160": "",
                    "custom_field_161": "",
                    "custom_field_162": "",
                    "custom_field_163": "",
                    "custom_field_164": "",
                    "custom_field_165": "",
                    "custom_field_166": "",
                    "custom_field_167": "",
                    "custom_field_168": "",
                    "custom_field_169": "",
                    "custom_field_170": "",
                    "custom_field_171": "",
                    "custom_field_172": "",
                    "custom_field_173": "",
                    "custom_field_174": "",
                    "custom_field_175": "",
                    "custom_field_176": "",
                    "custom_field_177": "",
                    "custom_field_178": "",
                    "custom_field_179": "",
                    "custom_field_180": "",
                    "custom_field_181": "",
                    "custom_field_182": "",
                    "custom_field_183": "",
                    "custom_field_184": "",
                    "custom_field_185": "",
                    "custom_field_186": "",
                    "custom_field_187": "",
                    "custom_field_188": "",
                    "custom_field_189": "",
                    "custom_field_190": "",
                    "custom_field_191": "",
                    "custom_field_192": "",
                    "custom_field_193": "",
                    "custom_field_194": "",
                    "custom_field_195": "",
                    "custom_field_196": "",
                    "custom_field_197": "",
                    "custom_field_198": "",
                    "custom_field_199": "",
                    "custom_field_200": "",
                    "ID": "1000009",
                    "is_followed": "0",
                    "iteration_name": "",
                    "story_name": "",
                    "release_name": "",
                    "template_name": "\u7cfb\u7edf\u9ed8\u8ba4\u6a21\u677f",
                    "status_alias": "\u63a5\u53d7\/\u5904\u7406",
                    "workspace_name": "\u5927\u578b\u56e2\u961f\u654f\u6377\u7814\u53d1",
                    "enable_quickly_transfer": "0"
                },
                "BugStoryRelation": [],
                "copy_info": {
                    "url": "https:\/\/www.tapd.cn\/tapd_fe\/60498179\/bug\/detail\/1160498179001000009",
                    "convert_url": "",
                    "commit_keyword": "--bug=1000009 --user=\u672a\u547d\u540d\u5c0f\u7a0b\u5e8f {#name#} https:\/\/www.tapd.cn\/60498179\/s\/1000094",
                    "copy_id": "1000009"
                },
                "show_fields_info": {
                    "show_fields_memo": {
                        "version_report": "",
                        "module": "",
                        "priority": "",
                        "severity": "",
                        "current_owner": "",
                        "reporter": "",
                        "created": "",
                        "id": "",
                        "custom_field_one": "abc"
                    },
                    "show_fields": [
                        {
                            "name": "version_report",
                            "label": "\u53d1\u73b0\u7248\u672c",
                            "pure_options": [],
                            "html_type": "select",
                            "setting_url": "https:\/\/www.tapd.cn\/60498179\/versions",
                            "color_options": [],
                            "enable_color": "0",
                            "memo": ""
                        },
                        {
                            "name": "module",
                            "label": "\u6a21\u5757",
                            "pure_options": [],
                            "html_type": "select",
                            "setting_url": "https:\/\/www.tapd.cn\/60498179\/modules\/index",
                            "color_options": [],
                            "enable_color": "0",
                            "memo": ""
                        },
                        {
                            "name": "priority",
                            "label": "\u4f18\u5148\u7ea7",
                            "color_options": [
                                {
                                    "value": "urgent",
                                    "label": "\u7d27\u6025",
                                    "color": "#FF6770"
                                },
                                {
                                    "value": "high",
                                    "label": "\u9ad8",
                                    "color": "#FF6770"
                                },
                                {
                                    "value": "medium",
                                    "label": "\u4e2d",
                                    "color": "#28AB80"
                                },
                                {
                                    "value": "low",
                                    "label": "\u4f4e",
                                    "color": "#7C8597"
                                },
                                {
                                    "value": "insignificant",
                                    "label": "\u65e0\u5173\u7d27\u8981",
                                    "color": "#7C8597"
                                }
                            ],
                            "pure_options": [],
                            "html_type": "select",
                            "setting_url": "",
                            "enable_color": "0",
                            "memo": ""
                        },
                        {
                            "name": "severity",
                            "label": "\u4e25\u91cd\u7a0b\u5ea6",
                            "pure_options": [],
                            "html_type": "select",
                            "setting_url": "",
                            "color_options": [],
                            "enable_color": "0",
                            "memo": ""
                        },
                        {
                            "name": "current_owner",
                            "label": "\u5904\u7406\u4eba",
                            "pure_options": [],
                            "html_type": "user_chooser",
                            "setting_url": "",
                            "memo": ""
                        },
                        {
                            "name": "reporter",
                            "label": "\u521b\u5efa\u4eba",
                            "pure_options": [],
                            "html_type": "user_chooser",
                            "setting_url": "",
                            "memo": ""
                        },
                        {
                            "name": "created",
                            "label": "\u521b\u5efa\u65f6\u95f4",
                            "pure_options": [],
                            "html_type": "datetime",
                            "setting_url": "",
                            "memo": ""
                        },
                        {
                            "name": "id",
                            "label": "ID",
                            "pure_options": [],
                            "html_type": "input",
                            "setting_url": "",
                            "memo": ""
                        },
                        {
                            "name": "custom_field_one",
                            "label": "abc",
                            "pure_options": [],
                            "html_type": "text",
                            "setting_url": "",
                            "memo": "abc"
                        }
                    ],
                    "open_fields": [],
                    "editable_fields": {
                        "version_report": {
                            "editabled_type": "tselect",
                            "system_name": "version_report",
                            "required": "",
                            "options": [
                                {
                                    "value": "\u7248\u672c1",
                                    "label": "\u7248\u672c1"
                                }
                            ],
                            "tree_options": []
                        },
                        "module": {
                            "editabled_type": "tselect",
                            "system_name": "module",
                            "required": "",
                            "options": [
                                {
                                    "value": "\u6a21\u57571",
                                    "label": "\u6a21\u57571"
                                }
                            ],
                            "tree_options": []
                        },
                        "priority": {
                            "editabled_type": "tselect",
                            "system_name": "priority",
                            "required": "",
                            "options": [
                                {
                                    "value": "urgent",
                                    "label": "\u7d27\u6025"
                                },
                                {
                                    "value": "high",
                                    "label": "\u9ad8"
                                },
                                {
                                    "value": "medium",
                                    "label": "\u4e2d"
                                },
                                {
                                    "value": "low",
                                    "label": "\u4f4e"
                                },
                                {
                                    "value": "insignificant",
                                    "label": "\u65e0\u5173\u7d27\u8981"
                                }
                            ],
                            "tree_options": [],
                            "color_options": [
                                {
                                    "value": "urgent",
                                    "label": "\u7d27\u6025",
                                    "color": "#FF6770"
                                },
                                {
                                    "value": "high",
                                    "label": "\u9ad8",
                                    "color": "#FF6770"
                                },
                                {
                                    "value": "medium",
                                    "label": "\u4e2d",
                                    "color": "#28AB80"
                                },
                                {
                                    "value": "low",
                                    "label": "\u4f4e",
                                    "color": "#7C8597"
                                },
                                {
                                    "value": "insignificant",
                                    "label": "\u65e0\u5173\u7d27\u8981",
                                    "color": "#7C8597"
                                }
                            ]
                        },
                        "severity": {
                            "editabled_type": "tselect",
                            "system_name": "severity",
                            "required": "",
                            "options": [
                                {
                                    "value": "\u81f4\u547d",
                                    "label": "\u81f4\u547d"
                                },
                                {
                                    "value": "\u4e25\u91cd",
                                    "label": "\u4e25\u91cd"
                                },
                                {
                                    "value": "\u4e00\u822c",
                                    "label": "\u4e00\u822c"
                                },
                                {
                                    "value": "\u63d0\u793a",
                                    "label": "\u63d0\u793a"
                                },
                                {
                                    "value": "\u5efa\u8bae",
                                    "label": "\u5efa\u8bae"
                                }
                            ],
                            "tree_options": []
                        },
                        "current_owner": {
                            "editabled_type": "pinyinuserchooser",
                            "system_name": "current_owner",
                            "required": "",
                            "options": [
                                {
                                    "value": "data_source_url",
                                    "label": "https:\/\/www.tapd.cn\/"
                                },
                                {
                                    "value": "data_source_url_params",
                                    "label": "?workspace_id=60498179\u0026r=3"
                                }
                            ],
                            "tree_options": []
                        },
                        "custom_field_one": {
                            "editabled_type": "text",
                            "system_name": "custom_field_one",
                            "required": "",
                            "options": {
                                "": ""
                            },
                            "tree_options": [],
                            "label": "abc"
                        }
                    }
                },
                "is_followed": "0",
                "socket_login_data": {
                    "socket_path": "https:\/\/spider.tapd.cn\/workitems",
                    "login_data": {
                        "user_nick": "\u672a\u547d\u540d\u5c0f\u7a0b\u5e8f::328519613",
                        "workspace_id": "60498179",
                        "timespan": "1749718574.9494866",
                        "data_id": "workitems",
                        "token": "c1ea348e500cd3f0b6197e7a74adbd9848adc681"
                    },
                    "room_ids": [
                        "WORKITEMS_CHANGE_bug_detail_1160498179001000009"
                    ],
                    "socket_id": "60498179",
                    "need_disconnect": "1"
                },
                "is_limited_user": "",
                "comment_list": {
                    "count": "0",
                    "total_count": "0",
                    "comments": [],
                    "page_size": "10",
                    "current_page": "1"
                },
                "attachment_list": {
                    "prviewable_type": [
                        "et",
                        "ett",
                        "wps",
                        "wpt",
                        "doc",
                        "docx",
                        "xls",
                        "xlsx",
                        "png",
                        "bmp",
                        "gif",
                        "jpg",
                        "jpeg",
                        "txt",
                        "pdf",
                        "html",
                        "xml",
                        "htm",
                        "log"
                    ],
                    "attachments": [],
                    "is_enabled_document": "1",
                    "download_authority": "1",
                    "delete_authority": "1",
                    "edit_authority": "1",
                    "document_download_authority": "1",
                    "view_document_authority": "1",
                    "edit_document_authority": "1",
                    "delete_document_authority": "1",
                    "can_export_mindmap_pic": "",
                    "max_file_upload_size": "157286400",
                    "open_app_attachments": [],
                    "attachment_sort": [],
                    "permission_map": {
                        "60498179": {
                            "is_enabled_document": "1",
                            "download_authority": "1",
                            "delete_authority": "1",
                            "edit_authority": "1",
                            "document_download_authority": "1",
                            "view_document_authority": "1",
                            "edit_document_authority": "1",
                            "delete_document_authority": "1",
                            "can_export_mindmap_pic": "",
                            "max_file_upload_size": "157286400"
                        }
                    }
                },
                "file_list": [],
                "file_field_list": {
                    "60498179": []
                }
            },
            "meta": {
                "code": "0",
                "message": "success"
            },
            "timestamp": "1749718574"
        },
        "workspace": {
            "switches": {
                "sw_story_iteration": true,
                "sw_iteration": 1,
                "sw_story": 1,
                "sw_bug": 1,
                "sw_task": 0,
                "sw_measurement": 1,
                "sw_release": 0,
                "sw_launchform": 1,
                "sw_story_sourcefile": 0,
                "sw_story_category": 1,
                "sw_enable_bug_relate_story": 1,
                "sw_enable_support_platform": false,
                "sw_enable_external": 1,
                "sw_codereview": 1,
                "sw_sourcecode": 1,
                "sw_enable_mail_summarized": 0,
                "sw_totest_url": false,
                "sw_wiki": 1,
                "sw_tcase": 1,
                "sw_testplan": 1,
                "sw_feedback": 1,
                "sw_twitter": 0,
                "sw_discuss": 0,
                "sw_enabled_bug_workflow_config": false,
                "sw_file": 0,
                "sw_enable_external_wiki": 0,
                "sw_enable_external_bug": 1,
                "sw_enable_external_tobject": 0,
                "sw_document": 1,
                "sw_enable_external_document": 1,
                "sw_report": 1,
                "sw_gantt": 1,
                "sw_svn": 1,
                "sw_git": 0,
                "sw_enable_secret_story": 1,
                "sw_board": 0,
                "sw_gitlab_source": 0,
                "sw_github_source": 0,
                "sw_tgit_source": 1,
                "sw_svn_source": 0,
                "sw_p4_source": 0,
                "sw_jenkins": 0,
                "sw_dashboard": 0,
                "sw_delivery_app": 0,
                "sw_milestone": 0,
                "sw_app_checklist": 0,
                "sw_stat": 1,
                "sw_mobile_fast_transfer_story_status": 0,
                "sw_mobile_fast_transfer_bug_status": 0,
                "sw_roadmap": 0,
                "sw_pro_dashboard": 1,
                "sw_team_calendar": 0,
                "sw_testx": 1
            },
            "config": {
                "enable_multi_linkage_fields": "false"
            }
        }
    },
    "meta": {
        "code": 0,
        "message": "success"
    },
    "timestamp": 1749718574
}

















-- Bugs 表（缺陷基本信息）
CREATE TABLE bugs (
    id VARCHAR(36) PRIMARY KEY COMMENT '缺陷唯一标识（UUID 或业务ID）',
    project_id VARCHAR(36) NOT NULL COMMENT '关联项目ID',
    title TEXT NOT NULL COMMENT '缺陷标题（HTML实体编码）',
    description TEXT COMMENT '描述内容（HTML格式）',
    markdown_description TEXT COMMENT 'Markdown格式描述',
    description_type VARCHAR(10) COMMENT '描述类型（1: HTML, 2: Markdown）',
    enable_app_checklist TINYINT(1) DEFAULT 0 COMMENT '是否启用应用检查项（0/1）',
    self_is_checklist TINYINT(1) DEFAULT 0 COMMENT '是否为检查项（0/1）',
    enable_value_flow TINYINT(1) DEFAULT 0 COMMENT '是否启用价值流（0/1）',
    enable_story_mr_summary TINYINT(1) DEFAULT 0 COMMENT '是否启用需求MR汇总（0/1）',
    enable_bug_mr_summary TINYINT(1) DEFAULT 0 COMMENT '是否启用缺陷MR汇总（0/1）',
    enable_vsm TINYINT(1) DEFAULT 0 COMMENT '是否启用VSM（0/1）',
    enable_zhiyan TINYINT(1) DEFAULT 0 COMMENT '是否启用智验（0/1）',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    FOREIGN KEY (project_id) REFERENCES projects(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='缺陷基本信息表';

-- Projects 表（项目基础信息）
CREATE TABLE projects (
    id VARCHAR(36) PRIMARY KEY COMMENT '项目唯一标识（UUID 或业务ID）',
    name VARCHAR(255) NOT NULL COMMENT '项目名称',
    description TEXT COMMENT '项目描述',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='项目基础信息表';

-- TabSettings 表（缺陷标签设置）
CREATE TABLE tab_settings (
    id VARCHAR(36) PRIMARY KEY COMMENT '标签设置ID',
    bug_id VARCHAR(36) NOT NULL COMMENT '关联缺陷ID',
    tab_type ENUM('fold', 'unfold') NOT NULL COMMENT '标签类型（折叠/展开）',
    name VARCHAR(255) NOT NULL COMMENT '标签名称',
    url TEXT NOT NULL COMMENT '标签跳转URL',
    count INT NOT NULL DEFAULT 0 COMMENT '关联数量',
    params JSON COMMENT '参数（JSON格式）',
    default_value VARCHAR(255) COMMENT '默认值',
    original_name VARCHAR(255) NOT NULL COMMENT '原始名称',
    label VARCHAR(255) NOT NULL COMMENT '标签显示名称',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (bug_id) REFERENCES bugs(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='缺陷标签设置表';

-- CopyLinkConfig 表（复制链接配置）
CREATE TABLE copy_link_configs (
    id VARCHAR(36) PRIMARY KEY COMMENT '配置ID',
    name VARCHAR(255) NOT NULL COMMENT '配置名称',
    code VARCHAR(255) NOT NULL COMMENT '配置代码',
    display TINYINT(1) NOT NULL DEFAULT 1 COMMENT '是否显示',
    copy_type VARCHAR(50) NOT NULL COMMENT '复制类型（sys/business）',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='复制链接配置表';




-- 插入 Bugs 表示例数据
INSERT INTO bugs (
    id, project_id, title, description, markdown_description, 
    description_type, enable_app_checklist, self_is_checklist, 
    enable_value_flow, enable_story_mr_summary, enable_bug_mr_summary, 
    enable_vsm, enable_zhiyan
) VALUES (
    '1160498179001000009', '60498179', '【示例】缺陷2', 
    '<p>sadf&nbsp;</p><p><br /></p><p>sd&nbsp;</p>', 
    '', '1', FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE
);

-- 插入 TabSettings 表示例数据
INSERT INTO tab_settings (
    id, bug_id, tab_type, name, url, count, params, default_value, original_name, label
) VALUES (
    'TGitSubmit', '1160498179001000009', 'fold', 
    'TGit Submit', 
    'https://www.tapd.cn/60498179/tgit_source/show_commit?id=1160498179001000009&type=bug&only_content=1&microapp=1', 
    1, 
    '{"scm_type": "tgit", "sub_count": {"commit": "1"}}'::jsonb, 
    NULL, 'TGit', '腾讯工科提交'
);